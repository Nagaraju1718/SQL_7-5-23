-- CREATE  DATABASE ASSIGNMENT3;

-- CREATING CUSTOMER TABLE

CREATE TABLE CUSTOMER(
CUSTOMER_ID INT PRIMARY KEY NOT NULL,
CUST_NAME VARCHAR(30) NOT NULL,
CITY VARCHAR(20) NOT NULL,
GRADE INT,
SALESMAN_ID INT NOT NULL
);

SELECT * FROM CUSTOMER;

INSERT INTO CUSTOMER(CUSTOMER_ID,CUST_NAME,CITY,GRADE,SALESMAN_ID) VALUES(3002,'NICK RIMANDO','NEW YORK',100,5001),
(3007,'BRAD DAVIS','NEW YORK',200,5001),
(3005,'GRAHAM ZUSI','CALIFORNIA',200,5001),
(3008,'JULIAN GREEN','LONDON',300,5002),
(3004,'FABIAN JOHNSON','PARIS',300,5006),
(3009,'GEOFF CAMERON','BERLIN',100,5003),
(3003,'JOZY ALTIDOR','MOSCOW',200,5007);

INSERT INTO CUSTOMER(CUSTOMER_ID,CUST_NAME,CITY,SALESMAN_ID) VALUES(3001,'BRAD GUZAN','LONDON',5005);

-- CREATING SALESMAN TABLE

CREATE TABLE SALESMAN(
SALESMAN_ID INT PRIMARY KEY NOT NULL,
NAME VARCHAR(30) ,
CITY VARCHAR(20) ,
COMMISSION FLOAT(3)
);

INSERT INTO SALESMAN VALUES(5001,'JAMES HOOG','NEW YORK',0.15),
(5002,'NAIL KNITE','PARIS',0.13),
(5005,'PIT ALEX','LONDON',0.11),
(5006,'MC LYON','PARIS',0.14),
(5007,'PAUL ADAM','ROME',0.13),
(5003,'LAUSON HEN','SAN JOSE',0.12);

SELECT * FROM SALESMAN;

-- QUERY

SELECT C1.CUST_NAME,C1.CITY,C1.GRADE,S1.NAME,S1.CITY FROM CUSTOMER C1 LEFT JOIN SALESMAN S1 ON C1.SALESMAN_ID=S1.SALESMAN_ID
WHERE C1.GRADE<200 ORDER BY C1.CUSTOMER_ID;